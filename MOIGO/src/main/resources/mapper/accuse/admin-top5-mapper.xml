<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="acusseTop5">
	<resultMap type="acusseTop5" id="top5ResultMap">
		<id property="rNum" column="RNUM" />
		<result property="targetMember" column="TARGET_MEMBER" />
		<result property="targetGroup" column="TARGET_GROUP" />
		<result property="aCount" column="A_COUNT" />
	</resultMap>




	<select id="atop5memberList" resultMap="top5ResultMap">
	<![CDATA[
		SELECT * FROM (SELECT ROWNUM RNUM, PAGING.*
		FROM  (SELECT TARGET_MEMBER, 
		COUNT(*) A_COUNT FROM ACCUSE A
    	JOIN MEMBER M ON(M.MEMBER_NO= A.TARGET_MEMBER)
		WHERE TARGET_MEMBER is not null AND M.DELFLAG ='N'
		GROUP BY TARGET_MEMBER ORDER BY A_COUNT DESC) PAGING) 
		WHERE RNUM <6
		]]>
	</select>
	
	
	<select id="atop5groupList" resultMap="top5ResultMap">
	<![CDATA[
		SELECT * FROM (SELECT ROWNUM RNUM, PAGING.*
 		FROM  (SELECT TARGET_GROUP, 
		COUNT(*) A_COUNT FROM ACCUSE A
    	JOIN GROUPS G ON(A.TARGET_GROUP=G.GROUP_NO)
		WHERE TARGET_GROUP is not null AND GROUP_STATE_CODE ='S1'
		GROUP BY TARGET_GROUP ORDER BY A_COUNT DESC) PAGING) 
		WHERE RNUM <6
		]]>
	</select>


</mapper>

