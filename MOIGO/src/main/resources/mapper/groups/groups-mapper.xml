<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="groups">

	<resultMap type="groups" id="groupsResultMap">
		<id property="groupNo" column="GROUP_NO"/>
		<result property="groupName" column="GROUP_NAME"/>
		<result property="groupMsg" column="GROUP_MSG"/>
		<result property="groupPicture" column="GROUP_PICTURE"/>
		<result property="groupGradeCode" column="GROUP_GRADE_CODE"/>
		<result property="groupStateCode" column="GROUP_STATE_CODE"/>
		<result property="maxMember" column="MAX_MEMBER"/>
		<result property="enrollDate" column="ENROLL_DATE"/>
		<result property="interestBigCode" column="INTEREST_BIG_CODE"/>
		<result property="interestSmallCode" column="INTEREST_SMALL_CODE"/>
		<result property="allowSignup" column="ALLOW_SIGNUP"/>
		<result property="minAge" column="MIN_AGE"/>
		<result property="maxAge" column="MAX_AGE"/>
		<result property="groupGender" column="GROUP_GENDER"/>
		<result property="openSetting" column="OPEN_SETTING"/>
	</resultMap>
	
	<select id="selectGroupList" resultMap="groupsResultMap">
	SELECT * FROM GROUPS
	</select>
	

	<!-- 혜진 -->
	
	<resultMap type="groupMember" id="groupMemberResultMap">
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="groupNo" column="GROUP_NO"/>
		<result property="profileImg" column="PROFILE_IMG"/>
		<result property="profileThumb" column="PROFILE_THUMB"/>
		<result property="profileMsg" column="PROFILE_MSG"/>
		<result property="memberGradeCode" column="MEMBER_GRADE_CODE"/>
		<result property="memberName" column="MEMBER_NAME"/>
	</resultMap>
	
	<select id="selectGroupMemberList" resultMap="groupMemberResultMap">
		SELECT GM.*, M.MEMBER_NAME
		FROM GROUP_MEMBER GM, MEMBER M 
		WHERE GM.MEMBER_NO = M.MEMBER_NO
		AND GROUP_NO = #{groupNo}
		ORDER BY 6 DESC, 7
	</select>
	
	<select id="searchGroupMemberList" parameterType="hashmap" resultMap="groupMemberResultMap">
		SELECT GM.*, M.MEMBER_NAME
		FROM GROUP_MEMBER GM, MEMBER M 
		WHERE GM.MEMBER_NO = M.MEMBER_NO
		AND GROUP_NO = #{groupNo}
		AND M.MEMBER_NAME LIKE #{searchName}||'%'
		ORDER BY 6 DESC, 7
	</select>
	
</mapper>
	